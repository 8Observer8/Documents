[B]Инструкция для сборки приложений на Qt в один exe без зависимостей от libstdc++-6.dll, libgcc_s_dw2-1.dll, Qt5Core.dll, Qt5Gui.dll и т.д.[/B]

[B]Инструментарий:[/B]
- Версия Qt: Qt 5.2.0 for Windows 32-bit (MinGW 4.8, OpenGL, 689 MB)

[B]Примечание:[/B] после сборки можно будет создавать статические приложения, которые не требуют библиотек Qt и MinGW. Можно будет переключаться между сборками (которая по умолчанию и статической) через QtCreator.

- скачиваем и устанавливаем Qt 5.2.0 for Windows 32-bit (MinGW 4.8, OpenGL, 689 MB) (при установке ставим галочку Source Components) http://qt-project.org/downloads

- переходим в каталог C:\Qt\Qt5.2.0\5.2.0\Src\qtbase\mkspecs\win32-g++ и открываем файл "qmake.conf"

- в файле "qmake.conf" отыскиваем переменную QMAKE_LFLAGS и приравниваем ей значение, вот так:

[QUOTE]QMAKE_LFLAGS = -static -static-libgcc[/QUOTE]

- отрываем терминал Пуск -> Qt 5.2.0 -> 5.2.0 -> MinGW 4.8 (32-bit) -> Qt 5.2.0 for Desktop (MinGW 4.8 32 bit)

- переходим в каталог с исходниками Qt, для этого вводим команду и нажимаем "Enter":

[QUOTE]cd c:\Qt\Qt5.2.0\5.2.0\Src\qtbase[/QUOTE]

- конфигурируем этапы установки, для этого вводим команду и нажимаем "Enter":

[QUOTE]configure -static -prefix "C:\Qt\Qt5.2.0_static" -opengl desktop -nomake examples -nomake tests[/QUOTE]

- выбираем тип лицензии "Open Source Edition" и подтверждаем лицензию

- ожидаем окончания конфигурирования

- производим компиляцию исходников Qt, для этого вводим команду и нажимаем "Enter":

[QUOTE]mingw32-make[/QUOTE]

- ожидаем окончания компиляции исходников (на моей машине это заняло 1 час 20 минут)

- копируем файлы в каталог установки (каталог установки мы указали на этапе конфигурирования C:\Qt\Qt5.2.0_static), для этого вводим команду и нажимаем "Enter":

[QUOTE]mingw32-make install[/QUOTE]

- ожидаем окончания копирования

- запускаем QtCreator

- в меню нажимаем "Инструменты" -> нажимаем "Параметры"

- слева выбираем "Сборка и запуск", а справа выбираем вкладку "Профили Qt"

- нажимаем кнопку "Добавить" и указываем путь до qmake.exe "C:\Qt\Qt5.2.0_static\bin\qmake.exe"

- нажимаем кнопку "Применить"

- переходим на вкладку "Комплекты" и нажимаем кнопку "Добавить"

- в поле "Название" вводим имя Desktop Qt 5.2.0 Static MinGW 32 bit

- если поле "Отладчик" пусто, то нажимаем кнопку "Управление"

- нажимаем кнопку "Добавить", вводим название (например gdb) и указываем путь к отладчику "C:\Qt\Qt5.2.0\Tools\mingw48_32\bit\gdb.exe"

- нажимаем кнопку "Применить"

- возвращаемся на на вкладку "Комплекты"

- в выпадающем списке "Профиль Qt" выбираем тот, которые мы указали на вкладке "Профили Qt"

- выделяем комплект "Desktop Qt 5.2.0 Static MinGW 32 bit" и нажимаем кнопку "Сделать по умолчанию" (если хотим чтобы комплект для статической сборки был поумолчанию)

- нажимаем кнопку "OK"

- протестируем, что приложения собираются статически

- создадим проект, для этого в меню нажимаем "Файл" -> нажимаем "Новый файл или проект..."

- слева в списке "Проекты" выбираем "Приложения" -> справа выбираем "Приложения Qt Widgets"

- в поле "Название" вводим: Hello_Static_Qt

- в поле "Создать" в вводим путь к папке с проектами, например: I:\QtProjects

- нажимаем кнопку "Далее"

- ставим галочки (по умолчанию должно быть выбрано) на два комплекта:

Desktop Qt 5.2.0 MinGW 32 bit
Desktop Qt 5.2.0 Static MinGW 32 bit

- нажимаем кнопку "Далее" -> нажимаем кнопку "Завершить"

- на панели слева нажимаем "Проекты"

- в верхней части экрана нажимаем "Desktop Qt 5.2.0 Static MinGW 32 bit"

- в разделе "Настройки сборки" в выпадающем списке "Изменить конфигурацию сборки" выбираем "Выпуск"

- находим раздел "Этапы сборки"

- напротив "qmake" выбираем "Подробнее"

- в выпадающем списке "Конфигурация сборки qmake" выбираем "Выпуск"

- в поле "Дополнительные параметры" вводим: "CONFIG += release" (с двойными кавычками)

- на панели слева нажимаем "Редактор"

- в меню нажимаем "Сборка" и нажимаем "Собрать проект "Hello_Static_Qt""

- переходим в папку с exe-файлом и запускаем его: I:\QtProjects\build-Hello_Static_Qt-Desktop_Qt_5_2_0_Static_MinGW_32bit-Выпуск\release
